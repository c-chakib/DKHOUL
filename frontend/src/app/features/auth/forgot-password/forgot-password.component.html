<div class="md-auth">
  <div class="md-auth__content">
    <div class="md-auth-card elevation-z3">
      <!-- Header -->
      <div class="md-auth-card__header">
        <div class="md-auth-card__logo">
          <span class="material-icons md-auth-card__logo-icon">lock_reset</span>
          <h1 class="md-typescale-headline-large md-auth-card__title">DKHOUL</h1>
        </div>
      </div>

      <!-- Content -->
      <div class="md-auth-card__content">
        <!-- Form State -->
        <ng-container *ngIf="!emailSent">
          <div class="md-auth-card__header-section">
            <h2 class="md-typescale-headline-medium">Forgot Password?</h2>
            <p class="md-typescale-body-large md-auth-card__subtitle">
              No worries! Enter your email address and we'll send you instructions to reset your password.
            </p>
          </div>

          <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="md-form">
            <!-- Email Field -->
            <div class="md-form-field">
              <label for="email" class="md-form-field__label md-typescale-body-small">Email Address</label>
              <div class="md-form-field__input-wrapper">
                <span class="material-icons md-form-field__icon">email</span>
                <input 
                  id="email"
                  type="email"
                  formControlName="email"
                  placeholder="Enter your registered email"
                  class="md-form-field__input"
                  [class.md-form-field__input--error]="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched"
                  [disabled]="loading"
                >
              </div>
              <span class="md-form-field__error md-typescale-body-small" *ngIf="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched">
                {{ getErrorMessage('email') }}
              </span>
            </div>

            <!-- Submit Button -->
            <button 
              type="submit"
              class="md-btn md-btn--filled md-btn--primary md-btn--full-width"
              [disabled]="loading || forgotPasswordForm.invalid"
              [class.md-btn--loading]="loading"
            >
              <span class="md-btn__label" *ngIf="!loading">Send Reset Link</span>
              <span class="md-btn__loader" *ngIf="loading">
                <span class="md-spinner"></span>
              </span>
            </button>
          </form>

          <!-- Back to Login -->
          <div class="md-auth-card__footer">
            <a routerLink="/auth/login" class="md-link md-link--with-icon">
              <span class="material-icons md-link__icon">arrow_back</span>
              <span class="md-typescale-body-medium">Back to Login</span>
            </a>
          </div>
        </ng-container>

        <!-- Success State -->
        <ng-container *ngIf="emailSent">
          <div class="md-success-message">
            <div class="md-success-message__icon-wrapper elevation-z2">
              <span class="material-icons md-success-message__icon">mark_email_read</span>
            </div>
            
            <h2 class="md-typescale-headline-medium md-success-message__title">Check Your Email</h2>
            
            <p class="md-typescale-body-large md-success-message__description">
              We've sent password reset instructions to <strong>{{ forgotPasswordForm.value.email }}</strong>
            </p>
            
            <p class="md-typescale-body-medium md-success-message__instruction">
              Please check your inbox and follow the link to reset your password. The link will expire in 1 hour.
            </p>

            <!-- Action Buttons -->
            <div class="md-success-message__actions">
              <button routerLink="/auth/login" class="md-btn md-btn--filled md-btn--primary">
                <span class="material-icons md-btn__icon">login</span>
                <span class="md-btn__label">Back to Login</span>
              </button>
              <button (click)="resendEmail()" class="md-btn md-btn--outlined">
                <span class="material-icons md-btn__icon">refresh</span>
                <span class="md-btn__label">Resend Email</span>
              </button>
            </div>

            <!-- Help Text -->
            <div class="md-help-text">
              <span class="material-icons md-help-text__icon">info</span>
              <span class="md-typescale-body-small md-help-text__content">
                Didn't receive the email? Check your spam folder or try resending.
              </span>
            </div>
          </div>
        </ng-container>
      </div>
    </div>

    <!-- Info Cards -->
    <div class="md-info-cards">
      <div class="md-info-card elevation-z2">
        <div class="md-info-card__icon-wrapper">
          <span class="material-icons md-info-card__icon">security</span>
        </div>
        <h3 class="md-typescale-title-medium md-info-card__title">Secure Process</h3>
        <p class="md-typescale-body-medium md-info-card__description">
          Your password reset link is encrypted and expires after 1 hour for your security.
        </p>
      </div>
      
      <div class="md-info-card elevation-z2">
        <div class="md-info-card__icon-wrapper">
          <span class="material-icons md-info-card__icon">support_agent</span>
        </div>
        <h3 class="md-typescale-title-medium md-info-card__title">Need Help?</h3>
        <p class="md-typescale-body-medium md-info-card__description">
          Contact our support team 24/7 if you have any issues accessing your account.
        </p>
      </div>
    </div>
  </div>
</div>
