<div class="reset-password-container">
  <mat-card class="reset-password-card">
    <mat-card-header>
      <div class="logo">
        <mat-icon class="logo-icon">lock_open</mat-icon>
        <h1>DKHOUL</h1>
      </div>
    </mat-card-header>

    <mat-card-content>
      <div class="header-section">
        <h2>Reset Your Password</h2>
        <p class="subtitle">
          Create a strong, secure password for your account.
        </p>
      </div>

      <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="reset-password-form">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>New Password</mat-label>
          <input 
            matInput 
            [type]="hidePassword ? 'password' : 'text'"
            formControlName="password"
            placeholder="Enter your new password"
            [disabled]="loading"
          >
          <mat-icon matPrefix>lock</mat-icon>
          <button 
            mat-icon-button 
            matSuffix 
            type="button"
            (click)="hidePassword = !hidePassword"
            [disabled]="loading"
          >
            <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          <mat-error *ngIf="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched">
            {{ getErrorMessage('password') }}
          </mat-error>
        </mat-form-field>

        <!-- Password Strength Indicator -->
        <div class="password-strength" *ngIf="resetPasswordForm.get('password')?.value">
          <div class="strength-bar">
            <div 
              class="strength-fill" 
              [style.width.%]="getPasswordStrength().value"
              [style.background-color]="getPasswordStrength().color"
            ></div>
          </div>
          <span 
            class="strength-label"
            [style.color]="getPasswordStrength().color"
          >
            {{ getPasswordStrength().label }}
          </span>
        </div>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Confirm Password</mat-label>
          <input 
            matInput 
            [type]="hideConfirmPassword ? 'password' : 'text'"
            formControlName="confirmPassword"
            placeholder="Re-enter your new password"
            [disabled]="loading"
          >
          <mat-icon matPrefix>lock_outline</mat-icon>
          <button 
            mat-icon-button 
            matSuffix 
            type="button"
            (click)="hideConfirmPassword = !hideConfirmPassword"
            [disabled]="loading"
          >
            <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          <mat-error *ngIf="resetPasswordForm.get('confirmPassword')?.touched">
            {{ getErrorMessage('confirmPassword') }}
          </mat-error>
        </mat-form-field>

        <!-- Password Requirements -->
        <div class="password-requirements">
          <h4>Password must contain:</h4>
          <ul>
            <li [class.valid]="hasMinLength()">
              <mat-icon>{{ hasMinLength() ? 'check_circle' : 'cancel' }}</mat-icon>
              At least 8 characters
            </li>
            <li [class.valid]="hasUpperCase()">
              <mat-icon>{{ hasUpperCase() ? 'check_circle' : 'cancel' }}</mat-icon>
              One uppercase letter
            </li>
            <li [class.valid]="hasLowerCase()">
              <mat-icon>{{ hasLowerCase() ? 'check_circle' : 'cancel' }}</mat-icon>
              One lowercase letter
            </li>
            <li [class.valid]="hasNumber()">
              <mat-icon>{{ hasNumber() ? 'check_circle' : 'cancel' }}</mat-icon>
              One number
            </li>
            <li [class.valid]="hasSpecialChar()">
              <mat-icon>{{ hasSpecialChar() ? 'check_circle' : 'cancel' }}</mat-icon>
              One special character
            </li>
          </ul>
        </div>

        <button 
          mat-raised-button 
          color="primary" 
          type="submit"
          [disabled]="loading || resetPasswordForm.invalid"
          class="submit-button"
        >
          <span *ngIf="!loading">Reset Password</span>
          <mat-spinner *ngIf="loading" diameter="24"></mat-spinner>
        </button>
      </form>

      <div class="back-to-login">
        <mat-icon>arrow_back</mat-icon>
        <a routerLink="/auth/login">Back to Login</a>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Security Info -->
  <div class="security-info">
    <mat-icon>shield</mat-icon>
    <h3>Secure Password Reset</h3>
    <p>Your password reset link is valid for 1 hour and can only be used once for your security.</p>
  </div>
</div>
