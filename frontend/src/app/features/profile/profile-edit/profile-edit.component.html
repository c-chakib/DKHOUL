<div class="profile-edit-container">
  <mat-card>
    <mat-card-header>
      <h1>Edit Profile</h1>
      <p>Update your personal information</p>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        <!-- Cover Photo -->
        <div class="cover-section">
          <div class="cover-preview" [style.background-image]="'url(' + (coverPreview || '/assets/default-cover.jpg') + ')'">
            <button type="button" mat-mini-fab color="primary" class="upload-btn" (click)="coverInput.click()">
              <mat-icon>photo_camera</mat-icon>
            </button>
            <input #coverInput type="file" accept="image/*" (change)="onCoverSelect($event)" hidden>
          </div>
          <p class="hint">Recommended size: 1200x300px (Max 10MB)</p>
        </div>

        <!-- Avatar -->
        <div class="avatar-section">
          <img class="avatar-preview" [src]="avatarPreview || '/assets/default-avatar.png'" alt="Avatar">
          <button type="button" mat-mini-fab color="accent" class="upload-btn" (click)="avatarInput.click()">
            <mat-icon>photo_camera</mat-icon>
          </button>
          <input #avatarInput type="file" accept="image/*" (change)="onAvatarSelect($event)" hidden>
          <p class="hint">Recommended size: 400x400px (Max 5MB)</p>
        </div>

        <!-- Basic Info -->
        <div class="form-section">
          <h2>Basic Information</h2>
          <mat-form-field appearance="outline">
            <mat-label>Full Name</mat-label>
            <input matInput formControlName="name" placeholder="Enter your full name">
            <mat-icon matPrefix>person</mat-icon>
            <mat-error *ngIf="profileForm.get('name')?.hasError('required')">Name is required</mat-error>
            <mat-error *ngIf="profileForm.get('name')?.hasError('minlength')">Name must be at least 2 characters</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" placeholder="your@email.com">
            <mat-icon matPrefix>email</mat-icon>
            <mat-error *ngIf="profileForm.get('email')?.hasError('required')">Email is required</mat-error>
            <mat-error *ngIf="profileForm.get('email')?.hasError('email')">Invalid email format</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Phone</mat-label>
            <input matInput type="tel" formControlName="phone" placeholder="+1 234 567 8900">
            <mat-icon matPrefix>phone</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Bio</mat-label>
            <textarea matInput formControlName="bio" rows="3" placeholder="Tell us about yourself" maxlength="500"></textarea>
            <mat-icon matPrefix>info</mat-icon>
            <mat-hint align="end">{{ profileForm.get('bio')?.value?.length || 0 }}/500</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Description</mat-label>
            <textarea matInput formControlName="description" rows="5" placeholder="Detailed description" maxlength="1000"></textarea>
            <mat-icon matPrefix>description</mat-icon>
            <mat-hint align="end">{{ profileForm.get('description')?.value?.length || 0 }}/1000</mat-hint>
          </mat-form-field>
        </div>

        <!-- Location -->
        <div class="form-section" formGroupName="location">
          <h2>Location</h2>
          <mat-form-field appearance="outline">
            <mat-label>Address</mat-label>
            <input matInput formControlName="address" placeholder="Street address">
            <mat-icon matPrefix>home</mat-icon>
          </mat-form-field>

          <div class="row">
            <mat-form-field appearance="outline">
              <mat-label>City</mat-label>
              <input matInput formControlName="city" placeholder="City">
              <mat-icon matPrefix>location_city</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Country</mat-label>
              <input matInput formControlName="country" placeholder="Country">
              <mat-icon matPrefix>public</mat-icon>
            </mat-form-field>
          </div>
        </div>

        <!-- Actions -->
        <mat-card-actions>
          <button mat-raised-button type="button" (click)="cancel()">Cancel</button>
          <button mat-raised-button color="primary" type="submit" [disabled]="profileForm.invalid || loading">
            <mat-icon *ngIf="!loading">save</mat-icon>
            <mat-spinner *ngIf="loading" diameter="20"></mat-spinner>
            {{ loading ? 'Saving...' : 'Save Changes' }}
          </button>
        </mat-card-actions>
      </form>
    </mat-card-content>
  </mat-card>
</div>
