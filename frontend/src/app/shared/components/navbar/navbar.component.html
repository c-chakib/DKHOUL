<!-- Navbar - Figma Inspired Design -->
<header class="navbar-figma">
  <div class="navbar-container">
    <!-- Logo with SVG - Figma Style -->
    <button class="navbar-logo" (click)="navigateToHome()">
      <div class="logo-icon">
        <img src="/picture/overall/logo.png" alt="DKHOUL Logo" class="logo-img">
      </div>
      <div class="logo-text">
        <div class="brand-tagline">Discover Morocco</div>
      </div>
    </button>

    <!-- Desktop Navigation -->
    <nav class="nav-links-desktop">
      <!-- Marketing Layout: Marketplace + Investor -->
      <button class="nav-link" routerLink="/home" routerLinkActive="active" *ngIf="isMarketingLayout">
        <mat-icon>storefront</mat-icon>
        Marketplace
      </button>
      <button class="nav-link investor-link" routerLink="/investor" routerLinkActive="active" *ngIf="isMarketingLayout">
        <mat-icon>trending_up</mat-icon>
        Investisseurs
      </button>
      
      <!-- App Layout: Full navigation -->
      <button class="nav-link" routerLink="/home" routerLinkActive="active" *ngIf="!isMarketingLayout">
        Accueil
      </button>
      <button class="nav-link" routerLink="/services" routerLinkActive="active" *ngIf="!isMarketingLayout">
        Services
      </button>
      <button class="nav-link" routerLink="/dashboard" routerLinkActive="active" *ngIf="isLoggedIn && !isMarketingLayout">
        Dashboard
      </button>
      <button class="nav-link" routerLink="/services/create" routerLinkActive="active" *ngIf="(isProvider() || isAdmin()) && !isMarketingLayout">
        Devenir Host
      </button>
    </nav>

    <!-- Right Actions -->
    <div class="nav-actions">
      <!-- Language Selector -->
      <button mat-icon-button [matMenuTriggerFor]="langMenu" class="icon-button">
        <mat-icon>language</mat-icon>
      </button>
      <mat-menu #langMenu="matMenu" class="language-menu">
        <button mat-menu-item (click)="changeLanguage('fr')">
          <span class="flag">ðŸ‡«ðŸ‡·</span>
          <span>FranÃ§ais</span>
        </button>
        <button mat-menu-item (click)="changeLanguage('ar')">
          <span class="flag">ðŸ‡²ðŸ‡¦</span>
          <span>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
        </button>
        <button mat-menu-item (click)="changeLanguage('en')">
          <span class="flag">ðŸ‡¬ðŸ‡§</span>
          <span>English</span>
        </button>
      </mat-menu>

      <!-- Messages (Logged In) -->
      <button mat-icon-button class="icon-button" (click)="navigateToMessages()" *ngIf="isLoggedIn && !isMarketingLayout" [matBadge]="unreadMessages" matBadgeColor="warn" [matBadgeHidden]="unreadMessages === 0" [attr.aria-label]="unreadMessages > 0 ? unreadMessages + ' messages non lus' : 'Messages'">
        <mat-icon [attr.aria-hidden]="unreadMessages === 0 ? 'true' : 'false'">chat_bubble_outline</mat-icon>
      </button>

      <!-- Favorites (Logged In) -->
      <button mat-icon-button class="icon-button" *ngIf="isLoggedIn && !isMarketingLayout">
        <mat-icon>favorite_border</mat-icon>
      </button>

      <!-- Not Logged In (hidden on marketing pages) -->
      <ng-container *ngIf="!isLoggedIn && !isMarketingLayout">
        <button mat-button class="login-button" (click)="navigateToLogin()">
          Login
        </button>
        <button mat-raised-button class="signup-button" (click)="navigateToRegister()">
          S'inscrire
        </button>
      </ng-container>

      <!-- User Menu (Logged In, hidden on marketing pages) -->
      <button mat-icon-button [matMenuTriggerFor]="userMenu" class="user-avatar-button" *ngIf="isLoggedIn && !isMarketingLayout">
        <div class="user-avatar">
          <mat-icon>person</mat-icon>
        </div>
      </button>
      <mat-menu #userMenu="matMenu" class="user-menu-figma">
        <div class="user-menu-header">
          <div class="user-avatar-large">
            <mat-icon>account_circle</mat-icon>
          </div>
          <div class="user-info">
            <p class="user-name">{{ currentUser?.firstName }} {{ currentUser?.lastName }}</p>
            <p class="user-email">{{ currentUser?.email }}</p>
            <span class="user-badge" [class.provider]="isProvider()" [class.admin]="isAdmin()">
              {{ isAdmin() ? 'Admin' : isProvider() ? 'Host' : 'Voyageur' }}
            </span>
          </div>
        </div>
        <mat-divider></mat-divider>
        <button mat-menu-item (click)="navigateToProfile()">
          <mat-icon>person_outline</mat-icon>
          <span>Mon Profil</span>
        </button>
        <button mat-menu-item *ngIf="isProvider() || isAdmin()" (click)="navigateToDashboard()">
          <mat-icon>dashboard</mat-icon>
          <span>Mes Services</span>
        </button>
        <button mat-menu-item (click)="navigateToBookings()">
          <mat-icon>event_note</mat-icon>
          <span>Mes RÃ©servations</span>
        </button>
        <button mat-menu-item (click)="navigateToMessages()" [matBadge]="unreadMessages" matBadgeColor="warn" [matBadgeHidden]="unreadMessages === 0" [attr.aria-label]="unreadMessages > 0 ? unreadMessages + ' messages non lus' : 'Messages'">
          <mat-icon [attr.aria-hidden]="unreadMessages === 0 ? 'true' : 'false'">chat_bubble_outline</mat-icon>
          <span>Messages</span>
        </button>
        <button mat-menu-item>
          <mat-icon>settings</mat-icon>
          <span>ParamÃ¨tres</span>
        </button>
        <button mat-menu-item *ngIf="isAdmin()" (click)="navigateToAdmin()">
          <mat-icon>admin_panel_settings</mat-icon>
          <span>Admin Panel</span>
        </button>
        <mat-divider></mat-divider>
        <button mat-menu-item class="logout-item" (click)="logout()">
          <mat-icon color="warn">logout</mat-icon>
          <span>DÃ©connexion</span>
        </button>
      </mat-menu>

      <!-- Mobile Menu -->
      <button mat-icon-button class="mobile-menu-button" (click)="toggleMobileMenu()">
        <mat-icon>menu</mat-icon>
      </button>
    </div>
  </div>
</header>
